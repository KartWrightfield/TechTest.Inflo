@model UserManagement.Shared.Models.Logs.LogListViewModel

<h2>All Logs</h2>

<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0">Filters</h5>
    </div>
    <div class="card-body">
        <form method="get" asp-controller="Logs" asp-action="Index" class="row g-3">
            <input type="hidden" name="page" value="1" />
            <input type="hidden" name="pageSize" value="@Model.Filter.PageSize" />

            <div class="col-md-3">
                <label for="actionType" class="form-label">Action Type</label>
                <select class="form-select" id="actionType" name="actionType">
                    <option value="">All Actions</option>
                    <option value="Create" selected="@(Model.Filter.ActionType == "Create")">Create</option>
                    <option value="Delete" selected="@(Model.Filter.ActionType == "Delete")">Delete</option>
                    <option value="Login" selected="@(Model.Filter.ActionType == "Login")">Login</option>
                    <option value="Update" selected="@(Model.Filter.ActionType == "Update")">Update</option>
                </select>
            </div>

            <div class="col-md-3">
                <label for="entityType" class="form-label">Entity Type</label>
                <select class="form-select" id="entityType" name="entityType">
                    <option value="">All Entities</option>
                    <option value="User" selected="@(Model.Filter.EntityType == "User")">User</option>
                </select>
            </div>

            <div class="col-md-3">
                <label for="fromDate" class="form-label">From Date</label>
                <input type="date" class="form-control" id="fromDate" name="fromDate"
                       value="@Model.Filter.FromDate?.ToString("yyyy-MM-dd")" />
            </div>

            <div class="col-md-3">
                <label for="toDate" class="form-label">To Date</label>
                <input type="date" class="form-control" id="toDate" name="toDate"
                       value="@Model.Filter.ToDate?.ToString("yyyy-MM-dd")" />
            </div>

            <div class="col-12">
                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">Apply Filters</button>
                    <a asp-controller="Logs" asp-action="Index" class="btn btn-outline-secondary">Clear Filters</a>
                </div>
            </div>
        </form>
    </div>
</div>

<div class="table-responsive">
    <table class="table table-striped">
        <thead>
        <tr>
            <th>Timestamp</th>
            <th>Id</th>
            <th>Action</th>
            <th>Entity Type</th>
            <th>Entity Id</th>
            <th style="width: 1px;"></th>
        </tr>
        </thead>
        <tbody>
        @foreach (var log in Model.Logs)
        {
            <tr>
                <td>@log.Timestamp</td>
                <td>@log.Id</td>
                <td>@log.Action</td>
                <td>@log.EntityType</td>
                <td>@log.EntityId</td>
                <td>
                    <a asp-controller="Logs" asp-action="View" asp-route-id="@log.Id" class="btn btn-secondary">
                        Detail
                    </a>
                </td>
            </tr>
        }
        </tbody>
    </table>
</div>

@if (Model.TotalPages > 0)
{
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <li class="page-item @(!Model.HasPreviousPage ? "disabled" : "")">
                <a class="page-link" asp-controller="Logs" asp-action="Index"
                   asp-route-page="@(Model.CurrentPage - 1)"
                   asp-route-pageSize="@Model.Filter.PageSize"
                   asp-route-actionType="@Model.Filter.ActionType"
                   asp-route-entityType="@Model.Filter.EntityType"
                   asp-route-fromDate="@Model.Filter.FromDate?.ToString("yyyy-MM-dd")"
                   asp-route-toDate="@Model.Filter.ToDate?.ToString("yyyy-MM-dd")">
                    Previous
                </a>
            </li>

            @for (int i = 1; i <= Model.TotalPages; i++)
            {
                <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                    <a class="page-link" asp-controller="Logs" asp-action="Index"
                       asp-route-page="@i"
                       asp-route-pageSize="@Model.Filter.PageSize"
                       asp-route-actionType="@Model.Filter.ActionType"
                       asp-route-entityType="@Model.Filter.EntityType"
                       asp-route-fromDate="@Model.Filter.FromDate?.ToString("yyyy-MM-dd")"
                       asp-route-toDate="@Model.Filter.ToDate?.ToString("yyyy-MM-dd")">
                        @i
                    </a>
                </li>
            }

            <li class="page-item @(!Model.HasNextPage ? "disabled" : "")">
                <a class="page-link" asp-controller="Logs" asp-action="Index"
                   asp-route-page="@(Model.CurrentPage + 1)"
                   asp-route-pageSize="@Model.Filter.PageSize"
                   asp-route-actionType="@Model.Filter.ActionType"
                   asp-route-entityType="@Model.Filter.EntityType"
                   asp-route-fromDate="@Model.Filter.FromDate?.ToString("yyyy-MM-dd")"
                   asp-route-toDate="@Model.Filter.ToDate?.ToString("yyyy-MM-dd")">
                    Next
                </a>
            </li>
        </ul>
    </nav>
}
else
{
    <div class="alert alert-info mt-3">
        No logs found matching the current filters.
    </div>
}
